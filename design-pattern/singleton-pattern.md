# Singleton Pattern
: **객체의 인스턴스가 오직 1개만 생성되는 패턴**이다.

원래같으면 웹사이트는 고객의 요청이 올 때마다 객체를 생성했을 것이다.
싱글톤 패턴을 사용하면 객체가 딱 1개만 생성되고, 공유하도록 설계되었다.

```java
public class Singleton {

    private static Singleton instance = new Singleton();
    
    private Singleton() {
        // 생성자는 외부에서 호출(new)못하게 private 으로 지정해야 한다.
    }

    public static Singleton getInstance() {
        return instance;
    }

    public void say() {
        System.out.println("hi, there");
    }
}
```
- static영역에 객체 instance를 미리 하나 생성해둔다.
- 이 객체 인스턴스가 필요하면 오직 `getInstance()`메서드를 통해서만 조회할 수 있으며 이 메서드를 호출하면 항상 같은 인스턴스를 반환한다.
- 딱 1개의 객체 인스턴스만 존재해야하므로, 생성자를 private으로 막아서 혹시라고 외부에서 new키워드로 객체 인스턴스가 생성되는 걸 막는다.
> 싱글톤패턴을 구현하는 방법은 여러가지가 있다.  
> 여기서는 객체를 미리 생성해두는 가장 단순하고 안전한 방법을 선택했다.

### 싱글톤 패턴의 문제점
- 싱글톤 패턴을 구현하는 코드 자체가 많이 들어간다.
- 의존관계상 클라이언트가 구체 클래스에 의존한다. (DIP위반)
- 클라이언트가 구체 클래스에 의존해서 OCP원칙을 위반할 가능성이 높다.
- 테스트하기 어렵다.
- 내부 속성을 변경하거나 초기화하기 어렵다.
- private생성자로 자식클래스를 만들기 어렵다.
- 결론적으로 유연성이 떨어진다.
- 안티 패턴으로 불리기도 한다.

### SpringBoot Singleton Container
: 스프링 컨테이너는 싱글톤 패턴의 문제점을 해결하면서 객체인스턴스를 싱글톤으로 관리한다.

스프링 빈이 바로 싱글톤으로 관리되는 빈이다.

즉 스프링 컨테이너가 객체들을 싱글톤으로 관리해주는것이다. ~~스프링짱~~

> 싱글톤 객체는 상태를 유지(stateful)하게 설계하면 안된다. 무상태(stateless)로 설계해야한다  
- 특정 클라이언트에 의존적인 필드가 있으면 안된다.
- 특정 클라이언트가 값을 변경할 수 있는 필드가 있으면 안된다.
- 가급적 읽기만 가능해야한다.
- 필드대신에 자바에서 공유되지않는, 지역변수, 파라미터, ThreadLocal등을 사용해야한다.